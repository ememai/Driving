{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>{% block title %}RWANDA DRIVERS{% endblock %}</title>

    <!-- Favicon Links -->
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
    <link rel="icon" type="image/png" href="/static/favicon.jpg">
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/apple-touch-icon.png">
    <link rel="manifest" href="/static/site.webmanifest">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/static/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Mobile-optimized CSS -->
    <style>

        .bold-logo {
            font-weight: bold;
            font-size: 1.2rem;
        }
        /* Mobile-first styling */
        .navbar-nav {
            flex-wrap: nowrap;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        /* Custom dark yellow link styling */
        .btn-dark-yellow {
            background-color: #B8860B; /* Dark goldenrod */
            color: white;
            border: none;
            font-size: 1.1rem;
            padding: 0.5rem 1rem;
            border-radius: 0.1rem;
            text-decoration: none;
            margin-right: 0.5rem;
            white-space: nowrap;
        }
        .btn-dark-yellow:hover {
            background-color: #A0720A;
            color: white;
        }
        /* Standard nav-link for collapse items */
        .nav-link {
            font-size: 1.1rem;
            padding: 0.5rem 1rem;
        }
        @media (max-width: 767px) {
            .navbar-brand { font-size: 1.1rem; }
            .btn-dark-yellow { font-size: 1rem; padding: 0.4rem 0.8rem; }
            .message-container { margin-top: 1rem; }
            .alert h3 { font-size: 1rem; }
            footer p { font-size: 0.9rem; }
        }
    </style>
</head>

<body class="d-flex flex-column min-vh-100">
    <!-- Responsive Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light py-2">
        <div class="container">
            <!-- Brand/Logo -->
            <a class="navbar-brand bold-logo" href="/" >
                <img 
                    src="{% static 'img/logo.png' %}" 
                    alt="Logo" 
                    width="30" 
                    height="30" 
                    class="d-inline-block align-top"
                > 
                RWANDA DC
            </a>
            <!-- Always Visible Dark Yellow Links -->
            <div class="d-flex flex-nowrap gap-2">
                
                {% if not user.is_authenticated %}
                    <a class="btn btn-dark-yellow" href="{% url 'register' %}">Konti nshya</a>
                    <a class="btn btn-dark-yellow" href="{% url 'login' %}">Konti isanzwe</a>
                {% else %}
                     <a class="btn btn-dark-yellow" href="{% url 'subscription' %}">Ifatabuguzi</a> 
                    <a class="btn btn-dark-yellow" href="{% url 'contact' %}">Ubufasha</a>
                    {% if user.is_staff %}
                        <a class="btn btn-dark-yellow" href="{% url 'admin_dashboard' %}">Admin</a>
                    {% endif %}
                {% endif %}
            </div>
            {% if user.is_authenticated %}
                <!-- Toggler for collapse (Profile & Logout only) -->
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                        data-bs-target="#profileCollapse" aria-controls="profileCollapse"
                        aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <!-- Collapse containing Profile and Logout -->
                <div class="collapse navbar-collapse" id="profileCollapse">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="#">{{request.user.name}}</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'logout' %}">Logout</a>
                        </li>
                    </ul>
                </div>
            {% endif %}
        </div>
    </nav>

    {% include 'scheduled_hours.html' %}

    <style>
        .mobile-exam-times {
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            padding: 0.5rem 0;
        }
        .scrollable-times {
            display: flex;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            gap: 1rem;
            padding: 0 1rem;
        }
        .time-slot {
            flex: 0 0 auto;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            background: #e9ecef;
            color: #212529;
            text-decoration: none;
            font-size: 0.9rem;
            white-space: nowrap;
            transition: all 0.2s;
        }
        .time-slot.active {
            background: #007bff;
            color: white;
        }
        /* Hide scrollbar for Chrome/Safari */
        .scrollable-times::-webkit-scrollbar {
            display: none;
        }
        /* Hide scrollbar for IE/Edge/Firefox */
        .scrollable-times {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>

    <!-- Main Content -->
    <main class="flex-grow-1">
        <div class="message-container mt-3 mt-md-4">
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }} mb-2 py-2">
                    {% if message.level == 40 or message.level == 30 %}
                        <div class="text-danger small">{{ message }}</div>
                    {% else %}
                        <div class="small">{{ message }}</div>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
        <div class="container mt-3 mt-md-4 mb-4">
            {% block content %}{% endblock %}
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-light py-2 mt-auto">
        <div class="container">
            <p class="text-center text-muted small mb-0">&copy; 2025 RWANDA DRIVERS. All rights reserved.</p>
        </div>
    </footer>

    <!-- Bootstrap JS (with Popper.js) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Auto-scroll to current time slot
        document.addEventListener('DOMContentLoaded', () => {
            const activeSlot = document.querySelector('.time-slot.active');
            if (activeSlot) {
                activeSlot.scrollIntoView({
                    behavior: 'auto',
                    block: 'nearest',
                    inline: 'center'
                });
            }
        });
        // Add click feedback for time slots
        document.querySelectorAll('.time-slot').forEach(slot => {
            slot.addEventListener('click', function(e) {
                document.querySelectorAll('.time-slot').forEach(s => s.classList.remove('active'));
                this.classList.add('active');
            });
        });
    </script>
</body>

</html>
